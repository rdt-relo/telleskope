<?php include __DIR__ . '/header.html'; ?>

<?php
    $show_policy_consent_checkbox = false;
?>

<div class="container">
    <div id="user-action-box" class="card card-container wow zoomIn animated">
        <div class="head-logo">
            <img src="<?= $_COMPANY->val('logo') ?? '../../image/teleskope-logo.png' ?>" height="50px"/>
            <div class="title">Connect to <?= $_COMPANY->val('companyname') ?> <?= $_SESSION['app-name'] ?? '' ?> platform</div>
        </div>

        <?php if (!empty($success_message)) { ?>
            <div class="alert alert-success">
                <?= $success_message; ?>
            </div>
        <?php } ?>
        <?php if (!empty($error_message)) { ?>
            <div class="alert alert-danger">
                <?= $error_message; ?>
            </div>
        <?php } ?>

        
        <form id="recaptcha-enabled-form" class="form-horizontal" action="login" method="POST">
            <div class="form-group">
                <label class="control-label">Email:</label>
                <input type="email" class="form-control" name="login_external_email" placeholder="Email" value="<?=htmlspecialchars($loginExternalEmail)?>" autocomplete="off" required>
            </div>
            <div class="form-group">
                <label class="control-label">Password:</label>
                <input type="password" class="form-control" name="login_password" placeholder="*******" autocomplete="off" required>
            </div>
            <div class="form-group">
                <button type="submit" data-sitekey="<?=RECAPTCHA_SITE_KEY?>" data-callback='onRecaptchaSubmit' class="loginBtn loginBtn--common btn-block center-block g-recaptcha">
                    <?=htmlspecialchars($loginMethod['login_btn_label'] ?? 'Sign In')?>
                </button>
                <small class="mt-1 mb-1"><?=htmlspecialchars($loginMethod['login_btn_description']??'')?></small>
            </div>
            <div class="form-group ">
                <div class="row no-gutters">
                    <div class="col-12 col-sm-6"> 
                        <!-- Need an account?
                        <a href="verification">Sign Up</a> -->
                    </div>
                    <div class="col-12 col-sm-6">
                        <a href="forgotpassword" class="user-sm-pull-right">Reset Password</a>
                    </div>
                </div>
            </div>
        </form>

        <div class="mt-3" style="text-align: center; margin-top:8px; border-top: 1px solid #dedede"></div>
        <div class="text-center grecaptcha-label mb-0">Confidential â€“ For Internal Use Only</div>
        <br>
        <div class="grecaptcha-label">
            This site is protected by reCAPTCHA and the Google
            <a href="https://policies.google.com/privacy">Privacy Policy</a> and
            <a href="https://policies.google.com/terms">Terms of Service</a> apply.
        </div>
        <div id="footer-logo"></div>
    </div>
    <div style="height:2px;"> </div>
</div>

    <?php if ($show_policy_consent_checkbox){ ?>
    <script>
        $("#acceptPrivacyPolicyBlock").css('display', 'block');
        $(".loginSubmitBtn").addClass("disabled");
       
        $("#acceptPrivacyPolicy").click(function() {
            var checked = $(this).is(':checked');
            if (checked) {
                $(".loginSubmitBtn").removeClass("disabled");
            } else {
                $(".loginSubmitBtn").addClass("disabled");
            }
        });
        $('.loginSubmitBtn').click(function(e){
            if($(this).hasClass('disabled')){
                swal.fire({text:"Please accept the Privacy Policy & Terms of Service to continue"}).then( function(result) {
                    $("#acceptPrivacyPolicy").focus();
                });
                e.preventDefault();
            } else {
                let u = $(this).attr("href");
                $(this).attr("href", u+'&policy_accepted=yes');
            }
        });
    </script>
    <?php } ?>
</body>
</html>
