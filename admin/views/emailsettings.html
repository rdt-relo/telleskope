<style>
    input[type="range"] {
        margin: 20px 0;
        width: 100%;
        cursor: pointer;
    }
    input[type=range]:focus {
        outline: none;
    }
    input[type=range]::-webkit-slider-runnable-track {
        width: 100%;
        height: 4px;
        cursor: pointer;
        background: #0077b5;
        border-radius: 25px;
    }
    input[type=range]::-webkit-slider-thumb {
        height: 20px;
        width: 20px;
        border-radius: 50%;
        background: #fff;
        box-shadow: 0 0 4px 0 rgba(0,0,0, 1);
        cursor: pointer;
        -webkit-appearance: none;
        margin-top: -8px;
    }
    input[type=range]:focus::-webkit-slider-runnable-track {
        background: #0077b5;
    }
    .range-wrap {
        width: 500px;
        position: relative;
    }
    .range-value {
        position: absolute;
        top: -50%;
    }
    .range-value span {
        height: 24px;
        line-height: 24px;
        text-align: center;
        background: #0077b5;
        color: #fff;
        font-size: 12px;
        display: block;
        position: absolute;
        left: 50%;
        transform: translate(-50%, 0);
        border-radius: 6px;
    }
    .range-value span:before {
        content: "";
        position: absolute;
        width: 0;
        height: 0;
        border-top: 10px solid #0077b5;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        margin-top: -1px;
    }
    </style>
    
    <div class="tl-container-offset-lr">
        <div class="row">              
            <div class="col-12">
                <div class="card p-4">
                    <h1 class="mb-3"><?= $pagetitle; ?></h1><hr class="mb-1 mt-0">
                    
                    <?php if (!empty($disabled)) { ?>
                        <p class="text-danger mt-3 mb-3">
                            Your account needs to be in maintenance mode 2 or higher in order to change Email Settings. Please contact Teleskope Technical Support to make changes.
                        </p>
                    <?php } ?>
    
                    <form id="email_setting_form">
                        <input type="hidden" name="csrf_token" value="<?= Session::GetInstance()->csrf; ?>">
    
                        <div class="row mb-3 align-items-center mt-4">
                            <label class="col-sm-2 col-form-label">Send Email</label>
                            <div class="col-sm-6">
                                <div class="range-wrap">
                                    <div class="range-value" id="rangeV"></div>
                                    <input name="email_settings" id="range" type="range" min="0" max="2" value="<?= $_ZONE->val('email_settings'); ?>" step="1" <?= $disabled ?>>
                                </div>
                            </div>
                        </div>
    
                        <div class="row mb-3">
                            <label for="email_from_label" class="col-sm-2 col-form-label">Default From Name <span class="text-danger">*</span></label>
                            <div class="col-sm-6">
                                <input id="email_from_label" class="form-control" placeholder="Default From name for the zone" maxlength="64" name="email_from_label" value="<?= $_ZONE->val('email_from_label'); ?>" type="text" required <?= $disabled ?>>
                            </div>
                        </div>
    
                        <?php if ($_COMPANY->getEmailSettings()['custom_smtp']) { ?>
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Default From Address</label>
                            <div class="col-sm-6">
                                <input class="form-control" placeholder="Default From email address for the zone" maxlength="127" name="email_from" value="<?= $_ZONE->val('email_from'); ?>" type="email" <?= $disabled ?>>
                                <small class="text-danger d-block mt-1">Note: This setting only applies when custom SMTP integration is enabled</small>
                            </div>
                        </div>
                        <?php } else { ?>
                            <input type="hidden" name="email_from" value="">
                        <?php } ?>
    
                        <div class="row mb-3">
                            <label class="col-sm-2 col-form-label">Default Reply To Address</label>
                            <div class="col-sm-6">
                                <input class="form-control" placeholder="Default Reply To address for the zone" maxlength="127" name="email_reply_to" value="<?= $_ZONE->val('email_replyto'); ?>" type="email" <?= $disabled ?>>
                            </div>
                        </div>
    
                        <div class="text-center mt-4">
                            <button type="button" onclick="updateZoneEmailSetting()" name="submit" class="btn btn-primary" <?= $disabled ?>>Update Setting</button>
                        </div>
                    </form>
                </div>  
            </div>
        </div>
    </div>

    <script>
        var tipText = ['Email&nbsp;Disabled','Basic&nbsp;Email&nbsp;Enabled','All&nbsp;Email&nbsp;Enabled'];
        var toolTipText = ['All email is disabled.','All email except content publish emails','Basic Email + content publish emails'];
        const range = document.getElementById('range'),
              rangeV = document.getElementById('rangeV'),
              setValue = () => {
                  const newValue = Number((range.value - range.min) * 100 / (range.max - range.min)),
                        newPosition = 10 - (newValue * 0.2);
                  rangeV.innerHTML = `<span class="pl-2 link-pointer pr-2 px-2" title="${toolTipText[range.value]}">${tipText[range.value]}</span>`;
                  rangeV.style.left = `calc(${newValue}% + (${newPosition}px))`;
              };
        document.addEventListener("DOMContentLoaded", setValue);
        range.addEventListener('input', setValue);
        $("#range").mouseover(function() {
            var value = this.value;
            $("#range").prop('title', toolTipText[value]);
        });
    </script>
