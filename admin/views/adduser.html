<div class="container col-md-offset-2 margin-top">
    <div class="row">
        <div class="col-md-12">
            <div class="widget-simple-chart card-box">

                <div class="col-md-12 divider"><h6><?=(empty($id))?'Add User':'Edit User'?></h6></div>

                <p>
                    &emsp; Your organization uses single signon. In this configuration, you can only invite users to join.
                </p>
                <?php if(!empty($error)){ ?>
                <div id="hidemesage" class="col-md-12">
                    <div class="alert alert-dismissible alert-danger">
                        <?php echo $error; ?>
                    </div>
                </div>
                <?php } ?>
				<?php if(!empty($success)){ ?>
				<div id="hidemesage" class="col-md-12">
					<div class="alert alert-dismissible alert-success">
						<?php echo $success; ?>
					</div>
				</div>
				<?php } ?>

                <div class="col-md-7">
                    <form class="form-horizontal" method="post" name="adduser" id="adduser"
                          action="" enctype="multipart/form-data">
                        <input type="hidden" name="csrf_token" value="<?=Session::GetInstance()->csrf;?>">
                        <div class="form-group">
                            <label class="col-lg-3 control-label">First Name
								<span style="color: #ff0000;"> *</span></label>
                            <div class="col-lg-8">
                                <input class="form-control" placeholder="First Name" name="firstName"
                                       value="<?php if(!empty($id)){ echo $users[0]['firstname'];}?>" type="text"
                                       required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-lg-3 control-label">Last Name
								<span style="color: #ff0000;"> *</span></label>
                            <div class="col-lg-8">
                                <input class="form-control" placeholder="Last Name" name="lastName" type="text"
                                       value="<?php if(!empty($id)){ echo $users[0]['lastname'];}?>" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-lg-3 control-label">Email<span style="color: #ff0000;"> *</span></label>
                            <div class="col-lg-8">
                                <input class="form-control" placeholder="Email" id="employeeEmail" name="email"
                                       type="email" value="<?php if(!empty($id)){ echo $users[0]['email'];}?>"
										<?= empty($id)?'required':'disabled';?> >
                            </div>
                        </div>
						<?php if (!empty($id)) { ?>
						<!-- Ask for update to additional fields -->
                        <div class="form-group">
                            <label class="col-lg-3 control-label">Office Location</label>
                            <div class="col-lg-8">
                                <select class="form-control" name="homeOffice">
                                    <option value="">Select an option</option>
                                    <?php
                                    $branchCount = count($branches);
                                    if ($branchCount >0){
										for($c=0;$c<$branchCount;$c++){
											if($id>0){
												if($users[0]['homeoffice']==$branches[$c]['branchid']){ $sel="selected"; }else{ $sel="";}
											}else {
												$sel="";
											}
											echo "<option value='{$_COMPANY->encodeId($branches[$c]['branchid'])}' {$sel} >".htmlspecialchars($branches[$c]['branchname'])."</option>";
										}
                                    }else{
                                    	echo "<option value=''>Branches not configured</option>";
                                    }
									?>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-lg-3 control-label">Job Title</label>
                            <div class="col-lg-8">
                                <input class="form-control" placeholder="Job Title" name="jobTitle"
                                       value="<?php if(!empty($id)){ echo $users[0]['jobtitle'];}?>">
                            </div>
                        </div>

						<div class="form-group">
							<label class="col-lg-3 control-label">Department</label>
							<div class="col-lg-8">
								<select class="form-control" name="department">
									<option value="">Select an option</option>
									<?php
                                    $deptCount = count($departments);
                                    if ($deptCount >0){
									for($c=0;$c<$deptCount;$c++){
									if($id>0){
									if($users[0]['department']==$departments[$c]['departmentid']){ $sel="selected"; }else{ $sel="";}
									}else {
									$sel="";
									}
									echo "<option value='{$_COMPANY->encodeId($departments[$c]['departmentid'])}' {$sel} >".$departments[$c]['department']."</option>";
									}
									}else{
									echo "<option value=''>Departments not configured</option>";
									}
									?>
								</select>
							</div>
						</div>

                        <div class="form-group">
                            <label class="col-lg-3 control-label">Image</label>
                            <div class="col-lg-8">
                                <input class="text-box ignore" name="picture" id="Image" type="file">
								<?php if($users[0]['picture']!=""){ ?>
                                <div>
									<img class="img-table demo1" src="<?= $users[0]['picture'] ?>" alt="User profile picture" width="50" height="50" alt="Picture"></a>
								</div>
                                <?php  } ?>
                            </div>
                        </div>

						<?php } ?>
                        <div class="form-group">
                            <label class="col-lg-3 control-label"></label>
                            <div class="col-lg-8">
                                <?php if (isset($id)){ ?>
                                <button type="button" onclick="goBack()" class="btn btn-primary">Cancel</button>
                                <?php }else{?>
                                <button type="reset" class="btn btn-primary">Reset</button>
                                <?php } ?>
                                <button type="submit" name="submit" class="btn btn-primary">Submit</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
